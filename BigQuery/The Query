SELECT
  fullName,
  COUNT(citiesLived.place) WITHIN RECORD AS numberOfPlacesLibed,
  citiesLived.place,
  COUNT(citiesLied.yearsLived) WITHIN citiesLied AS numberOfItmesInEachCity,
FROM [dataset.tableId];
